C51 COMPILER V9.59.0.0   GPIO                                                              10/18/2018 22:09:37 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE GPIO
OBJECT MODULE PLACED IN .\Objects\gpio.obj
COMPILER INVOKED BY: E:\Keil5\C51\BIN\C51.EXE USERS\HardWare\gpio.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\USERS\HardWa
                    -re;.\USERS) DEBUG OBJECTEXTEND PRINT(.\Listings\gpio.lst) TABS(2) OBJECT(.\Objects\gpio.obj)

line level    source

   1          /****************************gpio.c********************************/
   2          
   3          #include "gpio.h"
   4          #include "STC15F2K60S2.h"
   5          #include "math.h"
   6          
   7          const enum
   8          {
   9            GPIOPort0 = 0,
  10            GPIOPort1,
  11            GPIOPort2,
  12            GPIOPort3,
  13            GPIOPort4
  14          }GPIOTypeDef_t;
  15          
  16          void GPIOx_SetBits(unsigned char GPIOx,unsigned char GPIO_Pin_x)
  17          {
*** WARNING C235 IN LINE 17 OF USERS\HardWare\gpio.c: parameter 1: different types
  18   1        switch(GPIOx)
  19   1        {
  20   2          case GPIOPort0:
  21   2            P0 |=(int)pow(2,GPIO_Pin_x);
  22   2          break;
  23   2          
  24   2          case GPIOPort1:
  25   2            P1 |=(int)pow(2,GPIO_Pin_x);
  26   2          break;
  27   2          
  28   2          case GPIOPort2:
  29   2            P2 |=(int)pow(2,GPIO_Pin_x);
  30   2          break;
  31   2          
  32   2          case GPIOPort3:
  33   2            P3 |=(int)pow(2,GPIO_Pin_x);
  34   2          break;
  35   2          
  36   2          case GPIOPort4:
  37   2            P4 |=(int)pow(2,GPIO_Pin_x);
  38   2          break;
  39   2          
  40   2          default:
  41   2            
  42   2          break;
  43   2        }
  44   1          
  45   1      }
  46          
  47          void GPIOx_ResetBits(unsigned char GPIOx,unsigned char GPIO_Pin_x)
  48          {
  49   1        switch(GPIOx)
  50   1        {
  51   2          case GPIOPort0:
  52   2            P0 &=(~(int)pow(2,GPIO_Pin_x));
  53   2          break;
C51 COMPILER V9.59.0.0   GPIO                                                              10/18/2018 22:09:37 PAGE 2   

  54   2          
  55   2          case GPIOPort1:
  56   2            P1 &=(~(int)pow(2,GPIO_Pin_x));
  57   2          break;
  58   2          
  59   2          case GPIOPort2:
  60   2            P2 &=(~(int)pow(2,GPIO_Pin_x));
  61   2          break;
  62   2          
  63   2          case GPIOPort3:
  64   2            P3 &=(~(int)pow(2,GPIO_Pin_x));
  65   2          break;
  66   2          
  67   2          case GPIOPort4:
  68   2            P4 &=(~(int)pow(2,GPIO_Pin_x));
  69   2          break;
  70   2          
  71   2          default:
  72   2            
  73   2          break;
  74   2        }
  75   1      
  76   1      }
  77          
  78          unsigned char GPIOx_ReadBits(unsigned char GPIOx, unsigned char GPIO_Pin_x)
  79          {
  80   1        unsigned char returnStatus=0;
  81   1        unsigned char GPIO_Pin_x_BIN=(int)pow(2,GPIO_Pin_x);
  82   1        
  83   1        switch(GPIOx)
  84   1        {
  85   2          case GPIOPort0:
  86   2            returnStatus = P0 & GPIO_Pin_x_BIN;
  87   2          break;
  88   2          
  89   2          case GPIOPort1:
  90   2            returnStatus = P1 & GPIO_Pin_x_BIN;
  91   2          break;
  92   2          
  93   2          case GPIOPort2:
  94   2            returnStatus = P2 & GPIO_Pin_x_BIN;
  95   2          break;
  96   2          
  97   2          case GPIOPort3:
  98   2            returnStatus = P3 & GPIO_Pin_x_BIN;
  99   2          break;
 100   2          
 101   2          default:
 102   2          break;
 103   2        }
 104   1        
 105   1        return (returnStatus>>GPIO_Pin_x);
 106   1      }
 107          
 108          #define GET_BIT_NUMBER    4
 109          void KeyControl(void)
 110          {
 111   1        unsigned char HighFour= (P1 & 0xf0);  
 112   1        P1= (~(HighFour>>4));
 113   1      
 114   1      }
 115          void ShowKeyValue(void)
C51 COMPILER V9.59.0.0   GPIO                                                              10/18/2018 22:09:37 PAGE 3   

 116          {
 117   1        unsigned char HighFour= ((P1 & 0xf0)>>4); 
 118   1        GPIOx_SetBits(1,2);
 119   1        GPIOx_SetBits(1,3);
 120   1      //  unsigned char codeMy=(HighFour&0x08)+(HighFour&0x04)*2+(HighFour&0x02)*1+(HighFour&0x01)*3
 121   1        if(HighFour==0x08)
 122   1        {
 123   2          GPIOx_ResetBits(1,0);
 124   2          GPIOx_ResetBits(1,1);
 125   2        }
 126   1        else if(HighFour==0x04)
 127   1        {
 128   2          GPIOx_SetBits(1,0);
 129   2          GPIOx_ResetBits(1,1);
 130   2        }else if(HighFour==0x02)
 131   1        {
 132   2          GPIOx_ResetBits(1,0);
 133   2          GPIOx_SetBits(1,1);
 134   2        }else if (HighFour==0x01)
 135   1        {
 136   2          GPIOx_SetBits(1,0);
 137   2          GPIOx_SetBits(1,1);
 138   2        }
 139   1      
 140   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    593    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1       6
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
